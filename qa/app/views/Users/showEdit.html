#{extends 'main.html' /}
#{set title:'User administration' /}

#{stylesheet 'jquery-ui-1.8.6.custom.css' /}
#{script 'jquery-ui-1.8.6.custom.min.js' /}

<div class="editing">
#{form @Users.editPost(post.id)}

	#{ifErrors}
    	<p class="error">
    		@{Users.myQuestions()}
    	</p>
 	#{/ifErrors}

	<p>
	<div class="textarea">
		#{field 'content'}
			<label for="content"></label>
			<textarea name="${field.name}">${post.historys.get(editionIndex).content}</textarea>
		#{/field}	
	</div>
	
	<p>
	<table>
	<tr>
		<td>
			<input type="submit" value="Edit"/>
		</td>
		
#{/form}

		<td>
		#{form @Users.deletePost(post.id)}
			<input type="submit" value="Delete"/>
		#{/form}
		</td>

		<td>
		#{form @Users.previousEdition(post.id, editionIndex)}
			<input type="submit" value="<<"/>
		#{/form}
		</td>
		
		<td>
		#{form @Users.nextEdition(post.id, editionIndex)}
			<input type="submit" value=">>"/>
		#{/form}
		</td>
	</tr>
	</table>
	<br>

#{form @Users.tagQuestion(post.id)}

	#{ifErrors}
    	<p class="error">
    	@{Users.myQuestions()}
    	</p>
 	#{/ifErrors}
	
	#{field 'name'}
		<label for="tag">tag your question:</label>
		<input type="text" name="name" id="name"/>
	#{/field}
	
	<script type="text/javascript">
	 	$(function () {
			var propose = #{jsAction @Users.proposeTag() /};
			$('input#name').autocomplete({
				delimiter: /(,|;)\s*/, // regex or character
				source: propose(),
				delay: 0,
			});
		});
	</script>
	
	
	<input type="submit" value="tag"/>
	
#{/form}

#{if !post.tags.isEmpty()}
	Actual tags for this question:
	#{list items:post.tags, as:'tag'}
   		<a href="@{Application.tagged(tag)}">${tag}</a>${tag_isLast ? '' : ', '}
	#{/list}
#{/if}
	
</div>
		