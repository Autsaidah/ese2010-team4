#{extends 'profileMain.html' /}
#{set title:'User Profile' /}

#{secure.check 'user'}
<div class="form" id="userForm">
#{form @Users.changeProfile()}
	<label for="author">Fullname: </label>
	<div class="userInfo">
		<input type="text" fullname="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().fullname}" readonly/>
    </div>

	<label for="author">Email: </label>
	<div class="userInfo">
		<input type="text" fullname="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().email}" readonly/>
	</div>
   
    <label for="author">Birthday: </label>
	<div class="userInfo">
		#{field 'birthday'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().getBirthday()}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="author">Age: </label>
	<div class="userInfo">
		<input type="text" fullname="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().calculateAge()}" readonly/>
	</div>
	
	<label for="author">Website: </label>
	<div class="userInfo">
		#{field 'website'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().website}" />
			<label for="content"></label>
		#{/field}
	</div>

	<label for="author">Work: </label>
	<div class="userInfo">
		#{field 'work'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().work}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="author">Programming Languages: </label>
	<div class="userInfo">
		#{field 'languages'}
			<input type="text" name="${field.name}" email="author" id="user-inp" value="${models.User.find("byEmail", controllers.Secure.Security.connected()).first().favoriteLanguages}" />
			<label for="content"></label>
		#{/field}
	</div>
	
	<label for="aboutMe">About Me: </label>
	<div class="userInfo">
		#{field 'aboutMe'}
			<br>
			<textarea name="${field.name}">${models.User.find("byEmail", controllers.Secure.Security.connected()).first().aboutMe}</textarea>
		#{/field}
	</div>

	<div>
		<input type="submit" value="Update"/>
	</div>
	
</div>
#{/form}

<hr>

<div id="userProfile">
	<label> Upload an Avatar:
	<form action="@{Users.uploadAvatar()}" method="POST" enctype="multipart/form-data">
		<table style="padding-left: 60px">
		<input type="file" id="avatar" name="avatar" />
		<input type="submit" value="Upload" />
		</table>
	</form> 

	<br></br>
	
	#{form @Users.updateAvatarPath()}
		#{field 'URL'}
			<label for="author">or enter an URL:
			<input type="text" name="${field.name}" email="author" id="user-inp"/>
			<label for="content">
			<input type="submit" value="Submit" />
		#{/field}
	#{/form}
</div>

#{/ secure.check}

<hr>


<div id="userProfile">

	

	<h3>Activities</h3>
	#{list items:activities, as:'activity'}
			<div class="activity">
		
		#{activity activity:activity /}
			</div>
     #{/list}
    
	<h3>Reputation Graph</h3>

	<div id="graph">
		<div id="graphcanvas" style="width:600px;height:300px"></div>
	</div>

<script id="source" language="javascript" type="text/javascript">
$(function () {
    var d1 = [];
	
	d1.push([${userToShow.getReputationPoint(0).timestamp}, ${userToShow.getReputationPoint(0).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(1).timestamp}, ${userToShow.getReputationPoint(1).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(2).timestamp}, ${userToShow.getReputationPoint(2).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(3).timestamp}, ${userToShow.getReputationPoint(3).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(4).timestamp}, ${userToShow.getReputationPoint(4).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(5).timestamp}, ${userToShow.getReputationPoint(5).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(6).timestamp}, ${userToShow.getReputationPoint(6).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(7).timestamp}, ${userToShow.getReputationPoint(7).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(8).timestamp}, ${userToShow.getReputationPoint(8).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(9).timestamp}, ${userToShow.getReputationPoint(9).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(10).timestamp}, ${userToShow.getReputationPoint(10).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(11).timestamp}, ${userToShow.getReputationPoint(11).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(12).timestamp}, ${userToShow.getReputationPoint(12).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(13).timestamp}, ${userToShow.getReputationPoint(13).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(14).timestamp}, ${userToShow.getReputationPoint(14).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(15).timestamp}, ${userToShow.getReputationPoint(15).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(16).timestamp}, ${userToShow.getReputationPoint(16).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(17).timestamp}, ${userToShow.getReputationPoint(17).repvalue}]);
   	d1.push([${userToShow.getReputationPoint(18).timestamp}, ${userToShow.getReputationPoint(18).repvalue}]);
    d1.push([${userToShow.getReputationPoint(19).timestamp}, ${userToShow.getReputationPoint(19).repvalue}]);
    d1.push([${userToShow.getReputationPoint(20).timestamp}, ${userToShow.getReputationPoint(20).repvalue}]);
    d1.push([${userToShow.getReputationPoint(21).timestamp}, ${userToShow.getReputationPoint(21).repvalue}]);
    d1.push([${userToShow.getReputationPoint(22).timestamp}, ${userToShow.getReputationPoint(22).repvalue}]);
    d1.push([${userToShow.getReputationPoint(23).timestamp}, ${userToShow.getReputationPoint(23).repvalue}]);
    d1.push([${userToShow.getReputationPoint(24).timestamp}, ${userToShow.getReputationPoint(24).repvalue}]);
    d1.push([${userToShow.getReputationPoint(25).timestamp}, ${userToShow.getReputationPoint(25).repvalue}]);
    d1.push([${userToShow.getReputationPoint(26).timestamp}, ${userToShow.getReputationPoint(26).repvalue}]);
    d1.push([${userToShow.getReputationPoint(27).timestamp}, ${userToShow.getReputationPoint(27).repvalue}]);
    d1.push([${userToShow.getReputationPoint(28).timestamp}, ${userToShow.getReputationPoint(28).repvalue}]);
    d1.push([${userToShow.getReputationPoint(29).timestamp}, ${userToShow.getReputationPoint(29).repvalue}]);
    d1.push([${userToShow.getReputationPoint(30).timestamp}, ${userToShow.getReputationPoint(30).repvalue}]);
    d1.push([${userToShow.getReputationPoint(31).timestamp}, ${userToShow.getReputationPoint(31).repvalue}]);
    
    $.plot($("#graphcanvas"), [ d1]);
});
</script>

#{if flash.success}
<br>
	<p class="success">${flash.success}</p>
#{/if}